# login-security-system

# Database Security Policy Implementation

## Group Members
* Nkaka Ganza Ivo 
* Lisa Ornella 
* Ndayizeye Eugene

## 1. What was the question about?
Our organization introduced a new security policy to strengthen system security. We were required to implement a database solution that monitors login behavior. 

Specifically, if a user attempts to log in with incorrect credentials more than **two times** in a single session or day, the system must immediately record the event and trigger a security alert in a separate table.

## 2. How we solved it
We implemented this solution using **Oracle SQL**.

1.  **Storage:** We created two tables:
    * `login_audit`: Logs every single login attempt (Success or Fail).
    * `security_alerts`: Stores high-priority alerts when the policy is violated.
2.  **Automation:** We created a **Database Trigger** (`trg_check_suspicious_login`).
    * The trigger runs automatically after every insertion into the audit table.
    * It checks how many failed attempts the user has made today.
    * We used `PRAGMA AUTONOMOUS_TRANSACTION` to allow the trigger to query the table while it is being updated (avoiding mutating table errors).
    * If the failure count exceeds 2, it automatically inserts a warning into the `security_alerts` table.

### Solution Code
Below is the SQL code used to implement the tables and the trigger logic.

```sql
/* Database Security Assignment 
   System: Oracle Database
*/

-- 1. Create Login Audit Table
CREATE TABLE login_audit (
    audit_id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    username VARCHAR2(100) NOT NULL,
    attempt_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    status VARCHAR2(10) CHECK (status IN ('SUCCESS', 'FAILED')),
    ip_address VARCHAR2(45)
);

-- 2. Create Security Alerts Table
CREATE TABLE security_alerts (
    alert_id NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
    username VARCHAR2(100) NOT NULL,
    failed_attempts NUMBER NOT NULL,
    alert_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    alert_message VARCHAR2(255),
    notification_contact VARCHAR2(100)
);

-- 3. Trigger for Suspicious Activity
CREATE OR REPLACE TRIGGER trg_check_suspicious_login
AFTER INSERT ON login_audit
FOR EACH ROW
DECLARE
    -- Use Autonomous Transaction to avoid "Mutating Table" errors in Oracle
    PRAGMA AUTONOMOUS_TRANSACTION; 
    v_fail_count NUMBER;
BEGIN
    IF :NEW.status = 'FAILED' THEN
        -- Count existing committed failures for the user for the current day
        SELECT COUNT(*) INTO v_fail_count
        FROM login_audit
        WHERE username = :NEW.username 
          AND status = 'FAILED'
          AND TRUNC(attempt_time) = TRUNC(SYSDATE);
          
        -- Logic: If existing failures + current one > 2, trigger alert
        IF (v_fail_count + 1) > 2 THEN
            INSERT INTO security_alerts 
            (username, failed_attempts, alert_message, notification_contact)
            VALUES 
            (:NEW.username, (v_fail_count + 1), 'Suspicious activity: Multiple failed login attempts.', 'admin@security.org');
            
            COMMIT; -- Commit the alert
        END IF;
    END IF;
    COMMIT; -- Close the autonomous transaction
END;
/
```

## 3. Results (Screenshots)

### Database Setup
<img width="406" height="174" alt="security_alerts" src="https://github.com/user-attachments/assets/2482db48-8525-4868-aacf-4c52c663d3f8" />

Security_alerts

<img width="409" height="162" alt="login_audit" src="https://github.com/user-attachments/assets/7c864010-6808-40dd-970a-30cfbdb707a1" />

login_audit

### Testing the Logic
<img width="693" height="260" alt="testing the logic" src="https://github.com/user-attachments/assets/0d4e6463-7897-47cb-a213-174a873f8f48" />

screenshot inserting the 3 failed rows

### Final Alert Verification

<img width="1298" height="373" alt="Screenshot 2025-11-26 023524" src="https://github.com/user-attachments/assets/694f6949-fa14-4c51-a006-7099808e9698" />
